.PHONY: install

install:
	@echo "â¡ï¸ Installation de Samba..."
	sudo dnf install -y samba samba-common samba-client

	@echo "ğŸ“ CrÃ©ation du rÃ©pertoire de partage..."
	sudo mkdir -p /srv/samba/share
	sudo chmod -R 0777 /srv/samba/share
	sudo chown -R nobody:nobody /srv/samba/share

	@echo "ğŸ§¾ DÃ©ploiement du fichier de configuration Samba..."
	sudo cp smb.conf /etc/samba/smb.conf

	@echo "ğŸ” Configuration dâ€™un utilisateur fictif Samba..."
	@id smbcanafront >/dev/null 2>&1 || sudo useradd -M -s /sbin/nologin smbcanafront
	echo -e "MotDePasseBidon\nMotDePasseBidon" | sudo smbpasswd -a smbcanafront

	@echo "ğŸ“¦ Droits sur le dossier partagÃ©..."
	sudo mkdir -p /home/cana/partage
	sudo chown -R smbcanafront:smbcanafront /home/cana/partage
	sudo chmod -R 770 /home/cana/partage

	@echo "ğŸ›¡ï¸ DÃ©sactivation de NetBIOS..."
	sudo systemctl stop nmb.service || true
	sudo systemctl disable nmb.service || true

	@echo "ğŸ”Œ Activation de Samba..."
	sudo systemctl daemon-reload
	sudo systemctl enable smb --now

	@echo "âœ… Samba installÃ© et activÃ© avec un partage appÃ¢t."
